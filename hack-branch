#!/usr/bin/env python
import sys, os, re

if len(sys.argv) > 2:
  print "usage: " + sys.argv[0] + " [<branch-like>]"
  sys.exit(1)

branch = sys.argv[1] if len(sys.argv) == 2 else None
dothack = os.path.expandvars("$HOME/.hack")
if not branch and os.path.exists(dothack): branch = open(dothack).read()
if not branch:
  print "Create ~/.hack with a branchname to call " + sys.argv[0] + " without an argument"
  sys.exit(1)

if not ":" in branch:
  hardcoded = ["master", "develop", "2.10.0-wip", "2.10.x"]
  if not branch in hardcoded:
    prefix = "ticket" if re.match("^\d+$", branch) else "topic"
    branch = prefix + "/" + branch
  branch = "scalamacros:" + branch

print branch